<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<link id="CustomTheme" type="text/css" rel="stylesheet" href="../../Resource/css/index/customLightBlue.css" />
<link id="EasyuiTheme" type="text/css" rel="stylesheet" href="../../Resource/js/easyUI/themes/easyuiLightBlue.css" />    
<link id="JqgridTheme" type="text/css" rel="stylesheet" href="../../Resource/js/jqueryUI/theme/jqgridLightBlue/jquery-ui-1.10.4.custom.css" />
<link type="text/css" rel="stylesheet" href="../../Resource/js/jqueryUI/theme/ui.jqgrid.css" />
<link type="text/css" rel="stylesheet" href="../../Resource/js/easyUI/themes/icon.css" />
<link type="text/css" rel="stylesheet" href="../../Resource/js/fileUpload/css/fileUpload.css" />
<style type="text/css">
	.editTable{
		margin-top: 1px;
		padding-top: 0px;
		padding-left: 0px;
		margin-left: 0px;
	}
	.editTable .datebox input[readonly="readonly"]{
		background-color: initial;
	}
</style>
</head>
<body>
<div id="toolbar" class="easyui-panel" style="padding:4px;border-width:0;border-bottom-width:1px;">
	#{PAGE_TOOLBAR_BUTTONROLE}
</div>
<div class="searchParamesPanel editTable">
	<form class="easyui-form panel-noscroll" enctype="multipart/form-data">
		<table class="editTable">
			<tr>
				<td class="editTitle" style="width:125px;">
					<label data-locale="SHEET_NO"/>
				</td>
				<td class="editControl">
					<input type="text" name="sheet_no" id="sheet_no" class="easyui-textbox" readonly="readonly"
						   style="width: 100%;"/>
				</td>
				<td class="editTitle"><label data-locale="CARRIER_NAME"/></td>
				<td class="editControl" width="25%">
					<input type="text" name="carrier_no" id="carrier_no" class="easyui-combobox" style="width: 100%;"/>
				</td>
				<td class="editTitle"><label data-locale="STATE"/></td>
				<td class="editControl">
					<input type="text" name="state" id="state" class="easyui-textbox" readonly="readonly"/>
				</td>

			</tr>

			<tr>
				<td class="editTitle" style="width:100px;">
					<label data-locale="CONTRACT_NO"/>
				</td>
				<td class="editControl" width="25%">
					<input type="text" name="contract_no" id="contract_no" data-options="required:true" class="easyui-textbox"  style="width: 100%;"/>
				</td>
				<td class="editTitle" style="width:100px;">
					<label data-locale="CONTRACT_NAME"/>
				</td>
				<td class="editControl" width="25%">
					<input type="text" name="contract_name" id="contract_name" data-options="required:true" class="easyui-textbox"  style="width: 100%;"/>
				</td>
				<td class="editTitle"><label data-locale="CONTRACT_TYPE"/></td>
				<td class="editControl">
					<input type="text" name="contract_type" id="contract_type" class="easyui-combobox" data-options="required:true"/>
				</td>
				<!--<td class="editTitle" style="width:100px;">
					<label data-locale="XUNJIA_NO"/>
				</td>
				<td class="editControl" width="25%">
					<input type="text" name="xunjia_no" id="xunjia_no" data-options="required:true" class="easyui-textbox"  style="width: 100%;"/>
				</td>-->
			<!--	<td class="editTitle" style="width:100px;">
					<label data-locale="CUS_CONTRACT_NO"/>
				</td>
				<td class="editControl" width="25%">
					<input type="text" name="cus_contract_no" id="cus_contract_no" data-options="required:true" class="easyui-textbox"  style="width: 100%;"/>
				</td>-->
			<!--	<td class="editTitle"><label data-locale="TAX_RATE"/></td>
				<td class="editControl">
					<input type="text" name="tax_rate" id="tax_rate" data-options="required:true,min:1,precision:2" class="easyui-numberbox"/>
				</td>-->
			</tr>
			<tr>
				<td class="editTitle"><label data-locale="CREATE_BY"/></td>
				<td class="editControl">
					<input type="text" name="create_by" id="create_by" class="easyui-textbox" readonly="readonly" style="width: 100%" />
				</td>
				<td class="editTitle"><label data-locale="CHECK_BY"/></td>
				<td class="editControl">
					<input type="text" name="create_by" id="check_by" class="easyui-textbox" readonly="readonly" style="width: 100%"/>
				</td>
				<td class="editTitle"><label data-locale="BEGIN_DATE"/></td>
				<td class="editControl">
					<input type="text" name="begin_date" editable="false" data-options="required:true"  id="begin_date" class="easyui-datebox" style="width: 100px"/>
					-
					<input type="text" name="end_date" editable="false" data-options="required:true" id="end_date" class="easyui-datebox" style="width: 100px"/>
				</td>
			</tr>
		</table>
	</form>
</div>
<div id="toolbar2" class="easyui-panel" style="padding: 4px; border-width:0; border-bottom-width:1px;">
	<a href="javascript:add_detail();" id="add_detail" class="easyui-linkbutton" style="display: inline-block;" plain="true" iconcls="icon-add">新增行</a>
	<a href="javascript:remove_detail();" id="remove_detail" class="easyui-linkbutton" style="display: inline-block;" plain="true" iconcls="icon-remove">删除行</a>
	<a href="javascript:import_detail();" id="import_detail" class="easyui-linkbutton" style="display: inline-block;" plain="true" iconcls="icon-undo">导入明细</a>
</div>
<div id="gridControl">
	<table id="gridTable"></table>
	<div id="gridPager"></div>
</div>
<div id="fileUpload" style="position: absolute; left: 50%; top: 50%;
	 width: 600px; height: 400px; margin-left: -300px; margin-top: -200px; display: none;"></div>
<script type="text/javascript" src="../../Resource/js/jquery-2.0.0.min.js"></script>
<script type="text/javascript" src="../../Resource/js/jquery.i18n.properties.js"></script>
<script type="text/javascript" src="../../Resource/js/jquery-migrate-1.2.1.min.js"></script>
<script type="text/javascript" src="../../Resource/js/easyUI/jquery.easyui.min.js"></script>
<script type="text/javascript" src="../../Resource/js/easyUI/easyui-lang-zh_CN.js"></script>
<script type="text/javascript" src="../../Resource/js/base/commonControl.js"></script>
<script type="text/javascript" src="../../Resource/js/base/commonBusiness.js"></script>
<script type="text/javascript" src="../../Resource/js/jqueryUI/i18n/grid.locale-cn.js"></script>
<script type="text/javascript" src="../../Resource/js/jqueryUI/jquery.jqGrid.min.js"></script>
<script type="text/javascript" src="../../Resource/js/My97DatePicker/WdatePicker.js"></script>
<script type="text/javascript" src="../../Resource/js/base/globalVariable.js"></script>
<script type="text/javascript" src="../../Resource/js/jqueryUI/plugins/grid.setcolumns.js"></script>
<script type="text/javascript" src="../../Resource/js/cookie/jquery.cookie.js"></script>
<script type="text/javascript" src="../../Resource/js/fileUpload/js/upload.js"></script>
<script type="text/javascript" src="../../Resource/js/fileUpload/js/file.js"></script>
<script language="javascript" type="text/javascript">

    $(function() {
        initScript();
        initStyle();
        loadList();
        initData();
        var parms = getUrlParms();
        if(parms.sheet_no){
            window.parent.onIframeSelect(parms.sheet_no);
		}

    });

    $(window).load(function() { hideLoading(); });

    var initStyle = function() {};

    var initScript = function() {};

    // 加载数据
    var initData = function() {
        getDictionaryData([{
            //初始化合同状态数据字典
            dicTypeCode : Global_DicType.CONTRACT_STATE,
            callback : function(callbackData) {
                window.CONTRACT_STATEMap = {};
                for(var i = 0; i < callbackData.length; i++){
                    CONTRACT_STATEMap[callbackData[i].dicvalue] = callbackData[i].dictext;
				}
            }
        },{
            //初始化运输方式数据字典
            dicTypeCode : Global_DicType.TRANS_MODE,
            callback : function(callbackData) {
                $("#gridTable").setColProp('trans_mode', { edittype: 'select', editoptions : {
					value : formatGridCombobox_ServerSelect(callbackData, true, "dictext", "dictext"),
					dataInit: ComboboxUtils.jqGrid_DefaulDataInit({
						data : callbackData,
						valueField : "dictext",
						textField : "dictext",
						onSelect : function(row){
						}
					})
				}});
            }
        },{
            //初始化暂定合同类型
            dicTypeCode : Global_DicType.Temp_ht_type,
            callback : function(callbackData) {
                $("#contract_type").combobox({
                    valueField: 'dicvalue',
                    textField: 'dictext',
                    panelHeight: 100,
                    editable: true
                });
                $("#contract_type").combobox("loadData", callbackData);
            }
        },{
            //初始化运输方案数据字典
            dicTypeCode : Global_DicType.TRANS_FANGAN,
            callback : function(callbackData) {
                $("#gridTable").setColProp('trans_fangan', { edittype: 'select', editoptions : {
                        value : formatGridCombobox_ServerSelect(callbackData, true, "dictext", "dictext"),
                        dataInit: ComboboxUtils.jqGrid_DefaulDataInit({
                            data : callbackData,
                            valueField : "dictext",
                            textField : "dictext",
                            onSelect : function(row){
                            }
                        })
                    }});
            }
        },{
            //初始化地点档案数据字典，用于起运地及目的地
            dicTypeCode : Global_DicType.CITY_ARCHIVE,
            callback : function(callbackData) {
                $("#gridTable").setColProp('begin_city', { edittype: 'select', editoptions : {
					value : formatGridCombobox_ServerSelect(callbackData, true, "dictext", "dictext"),
					dataInit: ComboboxUtils.jqGrid_DefaulDataInit({
						data : callbackData,
						valueField : "dictext",
						textField : "dictext",
						onSelect : function(row){
						}
					})
				}});
                $("#gridTable").setColProp('end_city', { edittype: 'select', editoptions : {
					value : formatGridCombobox_ServerSelect(callbackData, true, "dictext", "dictext"),
					dataInit: ComboboxUtils.jqGrid_DefaulDataInit({
						data : callbackData,
						valueField : "dictext",
						textField : "dictext",
						onSelect : function(row){
						}
					})
				}});
            }
        }]);

        getBaseData([{
            //初始化承运商运输方式数据字典
            dicTypeCode : Global_BaseDataKey.ZD_CARRIER,
            callback : function(callbackData) {
                $("#carrier_no").combobox({
                    valueField: 'code',
                    textField: 'name',
                    panelHeight: 200,
                    editable: true
                });
                $("#carrier_no").combobox("loadData", callbackData);
            }
        }]);

    };

    function remove(){
        loseGridFocus();
        $.messager.confirm('提示', '确认对该合同进行注销操作吗?', function (r) {
            if (r) {
                showLoading();
                var requestParam = {};
                requestParam.sheet_no = $("#sheet_no").textbox("getValue");
                $.ajax({
                    url :"../../Non_Ht_CarrierController/cancel?t=" + Math.random(),
                    data: requestParam,
                    success : function(dataObj){
                        if (isServerResultDataPass(dataObj)) {
                            loadDetail({
                                sheet_no : $("#sheet_no").textbox("getValue"),
                                msg : dataObj.resultDataFull
                            });
                        } else {
                            FailResultDataToTip(dataObj);
                            hideLoading();
                        }
                    }
                });
            }
        });
    }
    
    function check(){
        loseGridFocus();
        $.messager.confirm('提示', '确认对该合同进行审核操作吗?', function (r) {
            if (r) {
                showLoading();
                var requestParam = {};
                requestParam.sheet_no = $("#sheet_no").textbox("getValue");
                $.ajax({
                    url :"../../Non_Ht_CarrierController/check?t=" + Math.random(),
                    data: requestParam,
                    success : function(dataObj){
                        if (isServerResultDataPass(dataObj)) {
                            loadDetail({
                                sheet_no : $("#sheet_no").textbox("getValue"),
                                msg : dataObj.resultDataFull
                            });
                        } else {
                            FailResultDataToTip(dataObj);
                            hideLoading();
                        }
                    }
                });
            }
        });
	}

    function uncheck(){
        loseGridFocus();
        $.messager.confirm('提示', '确认对该合同进行反审核操作吗?', function (r) {
            if (r) {
                showLoading();
                var requestParam = {};
                requestParam.sheet_no = $("#sheet_no").textbox("getValue");
                $.ajax({
                    url :"../../Non_Ht_CarrierController/uncheck?t=" + Math.random(),
                    data: requestParam,
                    success : function(dataObj){
                        if (isServerResultDataPass(dataObj)) {
                            loadDetail({
                                sheet_no : $("#sheet_no").textbox("getValue"),
                                msg : dataObj.resultDataFull
                            });
                        } else {
                            FailResultDataToTip(dataObj);
                            hideLoading();
                        }
                    }
                });
            }
        });
    }

    function add() {
		$.messager.confirm('提示', '确定打开一个新界面?', function (r) {
			if (r) {
				showLoading();
                add_after();
			}
		});
    };

    function add_after(){
        location.href = location.pathname;
    }

    var saveValidationPass = function () {
        var validated = $("form").form('enableValidation').form('validate');
        if (!validated) {
            errorNotification({
                SimpleMessage: "保存操作中部分数据验证不通过"
            });
            return false;
        } else {
            return true;
        }
    }

    function save() {
        loseGridFocus();
        if (!saveValidationPass()) {
            return;
        }
        $.messager.confirm('提示', '确定保存吗?', function (r) {
            if(r){
                showLoading();
                save_after();
            }
        });
    }

	function save_after(){
        loseGridFocus();
        var ht_carrier_freightVOList = $("#gridTable").jqGrid("getRowData");
        for (var i = 0; i < ht_carrier_freightVOList.length; i++) {
            var curRowData = ht_carrier_freightVOList[i];
            if(curRowData.operator == "add"){
                curRowData.sn = "";
            }
            delete curRowData.operator;
        }

        var requestParam = {};
        requestParam.non_ht_carrierVO = FormUtils.toJSONObject('form');
        requestParam.non_ht_carrierVO.carrier_name = $("#carrier_no").combobox("getText");
        //requestParam.non_ht_carrierVO.tax_rate = $("#tax_rate").textbox("getValue")/100;
        requestParam.non_ht_carrier_freightVOList = ht_carrier_freightVOList;
        $.ajax({
            url :"../../Non_Ht_CarrierController/saveDetail?t=" + Math.random(),
            type: "POST",
            contentType: "application/json",
            data: JSON.stringify(requestParam),
            success : function(dataObj){
                if (isServerResultDataPass(dataObj)) {
                    loadDetail({
                        sheet_no : dataObj.resultDataFull.sheet_no,
                        msg : { simpleMessage : dataObj.resultDataFull.msg }
                    });
                } else {
                    FailResultDataToTip(dataObj);
                    hideLoading();
                }
            }
        });
    }

    var import_detail = function(){
        var importDetailUrl = "../../Non_Ht_CarrierController/importData?t="+ Math.random();
        var downModuleFileUrl = "../../Non_Ht_CarrierController/exportTemplate";
        if(!$("#fileUpload").zyUpload){
            alert("上传javascript插件未引入");
            return;
        }

        $("#fileUpload").zyUpload({
            itemWidth : "60px", // 文件项的宽度
            itemHeight : "60px", // 文件项的高度
            url : importDetailUrl,
            multiple : false, // 是否可以多个文件上传
            dragDrop : true, // 是否可以拖动上传文件
            del : true, // 是否可以删除文件
            finishDel : false, // 是否在上传文件完成后删除预览
            close : true,
            fileTypeFilter : [ 'xls', 'xlsx' ],
            remark : "<p>只能上传xls/xlsx格式文件</p>",
            isDownModuleFile : true,
            downModuleFileUrl : downModuleFileUrl,
            // 外部获得的回调接口
            onSelect : function(files, allFiles) { // 选择文件的回调方法
            },
            onDelete : function(file, surplusFiles) { // 删除一个文件的回调方法
            },
            onFailure : function(file) { // 文件上传失败的回调方法
            },
            onComplete : function(responseInfo) { // 上传完成的回调方法
                hideLoading();
                $("#fileUpload").empty();
                $("#fileUpload").hide();
                var dataObj = JSON.parse(responseInfo);
                if (isServerResultDataPass(dataObj)) {
                    var list = dataObj.resultDataFull;
					for(var i = 0; i < list.length; i++){
                        list[i].operator = "add";
					    add_detail(list[i]);
					}
                } else {
                    FailResultDataToTip(dataObj);
                }
            }
        });
	}


    var remove_detail = function() {
        loseGridFocus();
        var $gridObject = $("#gridTable");
        var selectRowItems = $gridObject.jqGrid("getGridParam", "selarrrow");
        if (selectRowItems.length == 0) {
            errorNotification({
                SimpleMessage : "请至少选择一行数据行进行操作"
            });
            return;
        }
        $.messager.confirm('提示', '确定删除选中的数据项吗?', function(r) {
            if (r) {
                for (var i = selectRowItems.length-1; i >= 0;i--) {
                    $gridObject.jqGrid("delRowData", selectRowItems[i]);
                }
            }
        });
    };
    // 加载数据详细信息
    var loadDetail = function(requestParam) {
        showLoading();
        $.ajax({
			url: '../../Non_Ht_CarrierController/getDetail?t=' + Math.random(),
            type: 'POST',
            data: "sheet_no="+requestParam.sheet_no,
        	success : function(dataObj) {
        		if (isServerResultDataPass(dataObj)) {
                    var ht_carrierVO = dataObj.resultDataFull.non_ht_carrierVO;
                    var ht_carrier_freightVOList = dataObj.resultDataFull.non_ht_carrier_freightVOList;

                    myDisabled($("#contract_no"))
                    $("#state").textbox("setValue", window.CONTRACT_STATEMap[ht_carrierVO.state]);
                    $("#sheet_no").textbox("setValue", ht_carrierVO.sheet_no);
                    $("#begin_date").textbox("setValue", ht_carrierVO.begin_date);
                    $("#end_date").textbox("setValue", ht_carrierVO.end_date);
                    $("#contract_no").textbox("setValue", ht_carrierVO.contract_no);
                    $("#contract_type").combobox("setValue", ht_carrierVO.contract_type);
                    $("#contract_name").textbox("setValue", ht_carrierVO.contract_name);
                    $("#cus_contract_no").textbox("setValue", ht_carrierVO.cus_contract_no);
                    $("#carrier_no").combobox("setValue", ht_carrierVO.carrier_no);
                    $("#xunjia_no").textbox("setValue", ht_carrierVO.xunjia_no);
                    //$("#tax_rate").numberbox("setValue", ht_carrierVO.tax_rate*100);
                    $("#create_by").textbox("setValue", ht_carrierVO.create_by+" "+ht_carrierVO.create_date);
                    if(ht_carrierVO.check_by){
                        $("#check_by").textbox("setValue", ht_carrierVO.check_by+" "+ht_carrierVO.check_date);
                    }
                    $("#gridTable")[0].addJSONData({
                        rows: ht_carrier_freightVOList,
                        total: "1",
                        page: "1",
                        records: ht_carrier_freightVOList.length
					});
                    if(requestParam.msg){
                        correctNotification(requestParam.msg);
                    }
                } else {
                    FailResultDataToTip(dataObj);
                }
                hideLoading();
        	}
        });
    };

    var add_detail = function (vo) {
        loseGridFocus();
        $("#gridTable").common_add({
            data : vo/*,
            isFirstClick : true*/
        });
    };

    var loadList = function() {
        $("#gridTable").jqGrid({
            url : "",
            datatype : "local",
            width : "none",
            autoCol : false,
            colNames : [
				'operator',
				'sn',
				$.i18n.prop('TRANS_MODE'),
                $.i18n.prop('TRANS_FANGAN'),
				$.i18n.prop('FIRST_MILEAGE'),
				$.i18n.prop('FIRST_PRICE'),
				$.i18n.prop('TWO_MILEAGE'),
				$.i18n.prop('TWO_PRICE'),
				$.i18n.prop('THREE_MILEAGE'),
				$.i18n.prop('THREE_PRICE'),
                $.i18n.prop('BEGIN_CITY'),
				$.i18n.prop('END_CITY'),
                $.i18n.prop('CROSS_SEA_AMOUNT'),
                $.i18n.prop('REMARK')
			],
            colModel : [
                { name: 'operator', index: 'operator', hidden: true, sortable : false, search: false },
                { name: 'sn', index: 'sn', hidden: true, sortable : false, search: false, key: true },
                { name: 'trans_mode', index: 'trans_mode', sortable : false, align: 'left', width: 160, search: true, searchoptions: { sopt : [ 'cn', 'eq', 'ne' ] }, editable:true, editrules:{} },
                { name: 'trans_fangan', index: 'trans_fangan', sortable : false, align: 'left', width: 100, search: true, searchoptions: { sopt : [ 'cn', 'eq', 'ne' ] }, editable:true, editrules:{} },
                { name: 'first_mileage', index: 'first_mileage', sortable : false, align: 'center', width: 90, search: true, searchoptions: { sopt : [ 'cn', 'eq', 'ne' ] }, editable:true, editrules:{number:true} },
                { name: 'first_price', index: 'first_price', align: 'center', sortable : false, width: 90, search: true, searchoptions: { sopt : [ 'cn', 'eq', 'ne' ] }, editable:true, editrules:{number:true} },
                { name: 'two_mileage', index: 'two_mileage', sortable : false, align: 'center', width: 90, search: true, searchoptions: { sopt : [ 'cn', 'eq', 'ne' ] }, editable:true, editrules:{number:true} },
                { name: 'two_price', index: 'two_price', sortable : false, align: 'center', width: 90, search: true, searchoptions: { sopt : [ 'cn', 'eq', 'ne' ] }, editable:true, editrules:{number:true} },
                { name: 'three_mileage', index: 'three_mileage', sortable : false, align: 'center', width: 90, search: true, searchoptions: { sopt : [ 'cn', 'eq', 'ne' ] }, editable:true, editrules : {number:true}/*,formatter:currencyFmatter(4)*/},
                { name: 'three_price', index: 'three_price', sortable : false, align: 'center', width: 90, search: true, searchoptions: { sopt : [ 'cn', 'eq', 'ne' ] }, editable:true, editrules : {number:true}/*,formatter:currencyFmatter(4)*/},
                { name: 'begin_city', index: 'begin_city', sortable : false, align: 'left', width: 90, search: true, searchoptions: { sopt : [ 'cn', 'eq', 'ne' ] }, editable:true, editrules:{} },
                { name: 'end_city', index: 'end_city', sortable : false, align: 'left', width: 90, search: true, searchoptions: { sopt : [ 'cn', 'eq', 'ne' ] }, editable:true, editrules:{} },
                { name: 'cross_sea_amount', index: 'cross_sea_amount', sortable : false, align: 'center', width: 90, search: true, searchoptions: { sopt : [ 'cn', 'eq', 'ne' ] }, editable:true, editrules : {number:true}/*,formatter:currencyFmatter(4)*/},
                { name: 'remark', index: 'remark', align: 'left', width: 150, sortable : false,search: true, searchoptions: { sopt : [ 'cn', 'eq', 'ne' ] }, editable:true, editrules : {}}
            ],
            shrinkToFit: false,
            altRows: true,
            sortable : false,
            altclass: 'gridSpacingClass',
            forceFit: true,
            cellLayout: 0,
            scroll: false,
            sortname: 'sn',
            sortorder: "asc",
            loadonce: true,
            mtype: "POST",
            viewrecords: true,
            rownumbers: true,
            multiselect: true,
            rowNum: -1,
            pager : "#gridPager",
            jsonReader : {
                root : "rows",
                total : "total",
                page : "page",
                records : "records",
                repeatitems : false
            },
            pginput:false,
            pgbuttons:false,
            cellEdit: true,
            cellsubmit: 'clientArray',
            gridComplete : function() {
                $(".cbox").shiftSelect();
            },
            loadComplete : function(xhr) {
                setGridHeightWidth();
                FailResultDataToTip(xhr);
            },
            ondblClickRow : function(moduleid) {
                //showChildModule(moduleid);
            }
        });
        $('#gridTable').jqGrid('navGrid', '#gridPager',{
            search : false,
            add : false,
            edit : false,
            del : false,
            refresh : false
        }, {}, {}, {}, {
            multipleSearch : false,
            closeOnEscape : false,
            closeAfterSearch : false
        });
        $('#gridTable').jqGrid('navButtonAdd', '#gridPager', {
            caption: $.i18n.prop('EXPORT_TO_EXCEL'),// 导出数据
            title: 'Export Datas',
            buttonicon: 'ui-icon-disk',
            onClickButton: function () {
                ExportToExcel.call(this, {
                    type: Global_BaseDataKey.EXPORT_TO_EXCEL_CURRENT
                });
            }
        });
        setGridHeightWidth();
    };
</script>
</body>
</html>
